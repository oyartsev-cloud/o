import{g as A,a as F,p as T,b as M,c as _,d as w}from"./assets/api-C8FInpZX.js";/* empty css                      */const B=10,S="your-energy-quote",y="your-energy-favorites",C=/^\w+(\.\w+)?@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/,P={Muscles:"muscles","Body parts":"bodypart",Equipment:"equipment"},t={quoteText:document.querySelector("[data-quote-text]"),quoteAuthor:document.querySelector("[data-quote-author]"),filterTabs:document.querySelectorAll("[data-filter-tab]"),filterCategories:document.querySelector("[data-filter-categories]"),categoriesBlock:document.querySelector("[data-categories-block]"),exercisesSection:document.querySelector(".exercises-section"),exercisesTitle:document.querySelector("[data-exercises-title]"),searchForm:document.querySelector("[data-search-form]"),searchInput:document.querySelector("[data-search-input]"),exercisesList:document.querySelector("[data-exercises-list]"),pagination:document.querySelector("[data-pagination]"),modalBackdrop:document.querySelector("[data-modal-backdrop]"),modalContent:document.querySelector("[data-modal-content]"),modalClose:document.querySelector("[data-modal-close]"),subscriptionForm:document.querySelector("[data-subscription-form]"),subscriptionSuccess:document.querySelector("[data-subscription-success]"),subscriptionError:document.querySelector("[data-subscription-error]"),ratingModalBackdrop:document.querySelector("[data-rating-modal-backdrop]"),ratingForm:document.querySelector("[data-rating-form]"),ratingError:document.querySelector("[data-rating-error]")};let n={activeFilterType:"Muscles",activeCategory:null,keyword:"",currentPage:1,totalPages:1,filtersData:[],exercisesData:{results:[],page:1,totalPages:1},modalExerciseId:null,ratingExerciseId:null};function x(e){!t.quoteText||!t.quoteAuthor||(t.quoteText.textContent=e.quote,t.quoteAuthor.textContent=e.author)}function I(){const e={page:n.currentPage,limit:B};n.keyword&&(e.keyword=n.keyword);const r=P[n.activeFilterType];return r&&n.activeCategory&&(e[r]=n.activeCategory),e}function m(){t.categoriesBlock&&(t.categoriesBlock.hidden=!!n.activeCategory),t.exercisesSection&&(t.exercisesSection.hidden=!n.activeCategory),t.exercisesTitle&&(t.exercisesTitle.textContent=n.activeCategory?`Exercises: ${n.activeCategory}`:"")}function k(){t.filterCategories&&(t.filterCategories.innerHTML=n.filtersData.length?n.filtersData.map(e=>`
    <li class="filter-category-item ${n.activeCategory===e.name?"active":""}">
      <button type="button" class="filter-category-btn" data-category-name="${l(e.name)}">
        <img src="${l(e.imgURL)}" alt="${l(e.name)}" loading="lazy" />
        <span class="filter-category-name">${u(e.name)}</span>
      </button>
    </li>
  `).join(""):'<li class="filter-categories-empty">No categories for this filter.</li>',t.filterCategories.querySelectorAll(".filter-category-btn").forEach(e=>{e.addEventListener("click",()=>{const r=e.getAttribute("data-category-name");n.activeCategory=r,n.currentPage=1,E(n.activeFilterType),b(),m()})}),m())}function l(e){const r=document.createElement("div");return r.textContent=e,r.innerHTML.replace(/"/g,"&quot;")}function u(e){const r=document.createElement("div");return r.textContent=e,r.innerHTML}function L(e,r=!1,i=null){const o=Math.round(Number(e))||0;let a="";for(let s=1;s<=5;s++){const c=s<=o;r&&i?a+=`<button type="button" class="modal-exercise-star-btn ${c?"filled":""}" data-rating="${s}" data-exercise-id="${l(i)}">★</button>`:a+=`<span class="exercise-card-rating-star ${c?"filled":""}">★</span>`}return a}function R(e){const r=L(e.rating,!1);return`
    <li class="exercise-card">
      <img class="exercise-card-image" src="${l(e.gifUrl)}" alt="${l(e.name)}" loading="lazy" />
      <div class="exercise-card-body">
        <h3 class="exercise-card-name">${u(e.name)}</h3>
        <div class="exercise-card-rating">${r}</div>
        <p class="exercise-card-meta">
          <span>${u(e.bodyPart)}</span>
          <span>${u(e.target)}</span>
        </p>
        <div class="exercise-card-footer">
          <span class="exercise-card-calories">${e.burnedCalories} cal</span>
          <span class="exercise-card-time">${e.time} min</span>
          <button type="button" class="exercise-card-start" data-exercise-id="${l(e._id)}">Start</button>
        </div>
      </div>
    </li>
  `}function D(){if(!t.exercisesList)return;const{results:e}=n.exercisesData;if(!e.length){t.exercisesList.innerHTML='<li class="exercises-empty">No exercises found. Try another filter or search.</li>';return}t.exercisesList.innerHTML=e.map(R).join(""),t.exercisesList.querySelectorAll(".exercise-card-start").forEach(r=>{r.addEventListener("click",()=>$(r.getAttribute("data-exercise-id")))})}function H(){if(!t.pagination)return;const{page:e,totalPages:r}=n.exercisesData;if(r<=1){t.pagination.innerHTML="";return}const i=[],o=a=>{i.push(`<button type="button" class="pagination-btn ${a===e?"active":""}" data-page="${a}">${a}</button>`)};if(r<=7)for(let a=1;a<=r;a++)o(a);else{o(1),e>3&&i.push('<span class="pagination-ellipsis">...</span>');const a=Math.max(2,e-1),s=Math.min(r-1,e+1);for(let c=a;c<=s;c++)o(c);e<r-2&&i.push('<span class="pagination-ellipsis">...</span>'),r>1&&o(r)}t.pagination.innerHTML=i.join(""),t.pagination.querySelectorAll(".pagination-btn").forEach(a=>{a.addEventListener("click",()=>{n.currentPage=Number(a.getAttribute("data-page")),b()})})}function v(){try{return JSON.parse(localStorage.getItem(y)||"[]")}catch{return[]}}function N(e){const r=v();r.some(i=>i._id===e._id)||(r.push(e),localStorage.setItem(y,JSON.stringify(r)))}function O(e){const r=v().filter(i=>i._id!==e);localStorage.setItem(y,JSON.stringify(r))}function q(e){return v().some(r=>r._id===e)}function U(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}async function G(){const e=U();try{const r=localStorage.getItem(S);if(r){const o=JSON.parse(r);if(o.date===e&&o.quote){x({quote:o.quote,author:o.author||""});return}}const i=await A();x(i),localStorage.setItem(S,JSON.stringify({date:e,quote:i.quote,author:i.author}))}catch{t.quoteText&&(t.quoteText.textContent="Failed to load quote."),t.quoteAuthor&&(t.quoteAuthor.textContent="")}}async function E(e){n.activeFilterType=e;try{const r=await F(e);n.filtersData=r.results||[],k()}catch{n.filtersData=[],k()}}async function b(){const e=I();try{const r=await _(e);n.exercisesData={results:r.results||[],page:r.page||1,totalPages:r.totalPages||1}}catch{n.exercisesData={results:[],page:1,totalPages:1}}D(),H(),m()}let d=null;function $(e){var i,o;if(n.modalExerciseId=e,!t.modalBackdrop||!t.modalContent)return;t.modalContent.innerHTML='<div class="modal-loading">Loading...</div>',t.modalBackdrop.hidden=!1,document.body.style.overflow="hidden";const r=()=>{var a,s;d&&((a=t.modalClose)==null||a.removeEventListener("click",d.onCloseClick),(s=t.modalBackdrop)==null||s.removeEventListener("click",d.onBackdropClick),document.removeEventListener("keydown",d.onEscape),d=null),t.modalBackdrop.hidden=!0,document.body.style.overflow="",n.modalExerciseId=null};d={onCloseClick:r,onBackdropClick:a=>{a.target===t.modalBackdrop&&r()},onEscape:a=>{a.key==="Escape"&&r()}},(i=t.modalClose)==null||i.addEventListener("click",d.onCloseClick),(o=t.modalBackdrop)==null||o.addEventListener("click",d.onBackdropClick),document.addEventListener("keydown",d.onEscape),w(e).then(a=>{const s=q(a._id),c=a.videoUrl?`<video class="modal-exercise-video" src="${l(a.videoUrl)}" controls></video>`:"",g=a.popularity!=null?a.popularity:"";t.modalContent.innerHTML=`
        ${c}
        <img class="modal-exercise-image" src="${l(a.gifUrl)}" alt="${l(a.name)}" />
        <h2 class="modal-exercise-name" id="modal-title">${u(a.name)}</h2>
        <div class="modal-exercise-rating-wrap">
          <span class="modal-exercise-rating-label">Rating</span>
          <div class="modal-exercise-stars" data-modal-stars>${L(a.rating,!1)}</div>
        </div>
        <p class="modal-exercise-meta">
          <span>${u(a.bodyPart)}</span> • <span>${u(a.target)}</span> • <span>${u(a.equipment)}</span><br />
          ${g?`Popularity: ${g}<br />`:""}
          ${a.burnedCalories} cal • ${a.time} min
        </p>
        <p class="modal-exercise-description">${u(a.description||"")}</p>
        <button type="button" class="modal-exercise-fav" data-modal-fav data-exercise-id="${l(a._id)}">${s?"Remove from Favorites":"Add to Favorites"}</button>
        <button type="button" class="modal-exercise-give-rating" data-modal-give-rating data-exercise-id="${l(a._id)}">Give a rating</button>
      `;const f=t.modalContent.querySelector("[data-modal-fav]");f&&f.addEventListener("click",()=>{q(a._id)?(O(a._id),f.textContent="Add to Favorites"):(N(a),f.textContent="Remove from Favorites")});const h=t.modalContent.querySelector("[data-modal-give-rating]");h&&h.addEventListener("click",()=>{r(),J(a._id)})},()=>{t.modalContent.innerHTML='<div class="modal-loading">Failed to load exercise.</div>'})}function J(e){n.ratingExerciseId=e;const r=t.ratingModalBackdrop,i=t.ratingForm;!r||!i||(i.reset(),t.ratingError&&(t.ratingError.hidden=!0),r.hidden=!1,document.body.style.overflow="hidden")}function p(){const e=t.ratingModalBackdrop;e&&(e.hidden=!0,document.body.style.overflow="",n.ratingExerciseId&&t.modalBackdrop&&$(n.ratingExerciseId),n.ratingExerciseId=null)}function z(){n.ratingExerciseId=null;const e=t.ratingModalBackdrop,r=document.querySelector("[data-rating-modal-close]");r&&r.addEventListener("click",p),e&&e.addEventListener("click",i=>{i.target===e&&p()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&e&&!e.hidden&&p()}),t.ratingForm&&t.ratingForm.addEventListener("submit",async i=>{i.preventDefault();const o=t.ratingForm.querySelector("[data-rating-email]"),a=((o==null?void 0:o.value)||"").trim(),s=t.ratingForm.querySelector('input[name="rating"]:checked'),c=s?Number(s.value):0;if(!C.test(a)){t.ratingError&&(t.ratingError.textContent="Enter a valid email (e.g. user@domain.com)",t.ratingError.hidden=!1);return}if(c<1||c>5){t.ratingError&&(t.ratingError.textContent="Please select a rating.",t.ratingError.hidden=!1);return}t.ratingError&&(t.ratingError.hidden=!0);try{await T(n.ratingExerciseId,c),p()}catch(g){t.ratingError&&(t.ratingError.textContent=g.message||"Failed to submit rating.",t.ratingError.hidden=!1)}})}function K(){t.filterTabs.forEach(e=>{e.addEventListener("click",()=>{const r=e.getAttribute("data-filter-tab");t.filterTabs.forEach(i=>{i.classList.remove("active"),i.setAttribute("aria-selected","false")}),e.classList.add("active"),e.setAttribute("aria-selected","true"),n.activeCategory=null,n.currentPage=1,E(r),m()})})}function Q(){t.searchForm&&t.searchForm.addEventListener("submit",e=>{var r;e.preventDefault(),n.keyword=(((r=t.searchInput)==null?void 0:r.value)||"").trim(),n.currentPage=1,b()})}function V(){t.subscriptionForm&&t.subscriptionForm.addEventListener("submit",async e=>{e.preventDefault();const r=e.target,i=r.querySelector('input[name="email"]'),o=((i==null?void 0:i.value)||"").trim();if(o){if(!C.test(o)){t.subscriptionError&&(t.subscriptionError.textContent="Enter a valid email (e.g. user@domain.com)",t.subscriptionError.hidden=!1);return}t.subscriptionSuccess&&(t.subscriptionSuccess.hidden=!0),t.subscriptionError&&(t.subscriptionError.hidden=!0,t.subscriptionError.textContent="");try{await M(o),t.subscriptionSuccess&&(t.subscriptionSuccess.hidden=!1),r.reset()}catch(a){t.subscriptionError&&(t.subscriptionError.textContent=a.message||"Subscription failed. Try again.",t.subscriptionError.hidden=!1)}}})}function j(){const e=document.querySelector("[data-burger]"),r=document.querySelector("[data-header-menu]");e&&r&&(e.addEventListener("click",()=>{const o=r.classList.toggle("is-open");e.setAttribute("aria-expanded",o)}),r.querySelectorAll(".header__nav-link").forEach(o=>{o.addEventListener("click",()=>{r.classList.remove("is-open"),e.setAttribute("aria-expanded","false")})}));const i=window.location.pathname;document.querySelectorAll(".header__nav-link").forEach(o=>{const a=o.getAttribute("href")==="./index.html"&&!i.includes("favorites")||o.getAttribute("href")==="./favorites.html"&&i.includes("favorites");o.classList.toggle("header__nav-link--current",a)})}function Y(){G(),E("Muscles"),m(),K(),Q(),z(),V(),j()}Y();
//# sourceMappingURL=index.js.map
