{"version":3,"file":"favorites.js","sources":["../src/favorites.js"],"sourcesContent":["import * as api from './js/api.js';\n\nconst QUOTE_STORAGE_KEY = 'your-energy-quote';\nconst FAVORITES_STORAGE_KEY = 'your-energy-favorites';\n\nfunction getDateKey() {\n  const d = new Date();\n  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\n}\n\nfunction getFavorites() {\n  try {\n    return JSON.parse(localStorage.getItem(FAVORITES_STORAGE_KEY) || '[]');\n  } catch {\n    return [];\n  }\n}\n\nfunction removeFavorite(id) {\n  const list = getFavorites().filter((e) => e._id !== id);\n  localStorage.setItem(FAVORITES_STORAGE_KEY, JSON.stringify(list));\n}\n\nfunction escapeAttr(str) {\n  const div = document.createElement('div');\n  div.textContent = str;\n  return div.innerHTML.replace(/\"/g, '&quot;');\n}\n\nfunction escapeHtml(str) {\n  const div = document.createElement('div');\n  div.textContent = str;\n  return div.innerHTML;\n}\n\nfunction renderStars(rating) {\n  const value = Math.round(Number(rating)) || 0;\n  let html = '';\n  for (let i = 1; i <= 5; i++) html += `<span class=\"exercise-card-rating-star ${i <= value ? 'filled' : ''}\">★</span>`;\n  return html;\n}\n\nfunction loadQuoteFromStorage() {\n  const quoteText = document.querySelector('[data-quote-text]');\n  const quoteAuthor = document.querySelector('[data-quote-author]');\n  const today = getDateKey();\n  const stored = localStorage.getItem(QUOTE_STORAGE_KEY);\n  if (stored) {\n    try {\n      const data = JSON.parse(stored);\n      if (data.date === today && data.quote) {\n        if (quoteText) quoteText.textContent = data.quote;\n        if (quoteAuthor) quoteAuthor.textContent = data.author || '';\n        return;\n      }\n    } catch (_) {}\n  }\n  if (quoteText) quoteText.textContent = 'Завантажте цитату на головній сторінці.';\n  if (quoteAuthor) quoteAuthor.textContent = '';\n}\n\nfunction renderFavoritesList() {\n  const listEl = document.querySelector('[data-favorites-list]');\n  const emptyEl = document.querySelector('[data-favorites-empty]');\n  const list = getFavorites();\n  if (!listEl) return;\n  if (!list.length) {\n    listEl.innerHTML = '';\n    if (emptyEl) emptyEl.hidden = false;\n    return;\n  }\n  if (emptyEl) emptyEl.hidden = true;\n  listEl.innerHTML = list\n    .map(\n      (ex) => `\n    <li class=\"exercise-card\">\n      <img class=\"exercise-card-image\" src=\"${escapeAttr(ex.gifUrl)}\" alt=\"${escapeAttr(ex.name)}\" loading=\"lazy\" />\n      <div class=\"exercise-card-body\">\n        <h3 class=\"exercise-card-name\">${escapeHtml(ex.name)}</h3>\n        <div class=\"exercise-card-rating\">${renderStars(ex.rating)}</div>\n        <p class=\"exercise-card-meta\"><span>${escapeHtml(ex.bodyPart)}</span> <span>${escapeHtml(ex.target)}</span></p>\n        <div class=\"exercise-card-footer\">\n          <span class=\"exercise-card-calories\">${ex.burnedCalories} cal</span>\n          <span class=\"exercise-card-time\">${ex.time} min</span>\n          <button type=\"button\" class=\"exercise-card-start\" data-exercise-id=\"${escapeAttr(ex._id)}\">Start</button>\n          <button type=\"button\" class=\"exercise-card-remove\" data-remove-id=\"${escapeAttr(ex._id)}\" aria-label=\"Remove from favorites\">&#10006;</button>\n        </div>\n      </div>\n    </li>\n  `\n    )\n    .join('');\n  listEl.querySelectorAll('.exercise-card-start').forEach((btn) => {\n    btn.addEventListener('click', () => openModal(btn.getAttribute('data-exercise-id')));\n  });\n  listEl.querySelectorAll('.exercise-card-remove').forEach((btn) => {\n    btn.addEventListener('click', () => {\n      removeFavorite(btn.getAttribute('data-remove-id'));\n      renderFavoritesList();\n    });\n  });\n}\n\nconst modalBackdrop = document.querySelector('[data-modal-backdrop]');\nconst modalContent = document.querySelector('[data-modal-content]');\nconst modalClose = document.querySelector('[data-modal-close]');\n\nfunction closeModal() {\n  if (modalBackdrop) modalBackdrop.hidden = true;\n  document.body.style.overflow = '';\n}\n\nfunction openModal(exerciseId) {\n  if (!modalBackdrop || !modalContent) return;\n  modalContent.innerHTML = '<div class=\"modal-loading\">Loading...</div>';\n  modalBackdrop.hidden = false;\n  document.body.style.overflow = 'hidden';\n\n  const onClose = () => {\n    modalClose?.removeEventListener('click', onClose);\n    modalBackdrop?.removeEventListener('click', onBackdrop);\n    document.removeEventListener('keydown', onEscape);\n    closeModal();\n  };\n  const onBackdrop = (e) => { if (e.target === modalBackdrop) onClose(); };\n  const onEscape = (e) => { if (e.key === 'Escape') onClose(); };\n  modalClose?.addEventListener('click', onClose);\n  modalBackdrop?.addEventListener('click', onBackdrop);\n  document.addEventListener('keydown', onEscape);\n\n  api.getExerciseById(exerciseId).then(\n    (exercise) => {\n      const fav = getFavorites().some((e) => e._id === exercise._id);\n      modalContent.innerHTML = `\n        <img class=\"modal-exercise-image\" src=\"${escapeAttr(exercise.gifUrl)}\" alt=\"${escapeAttr(exercise.name)}\" />\n        <h2 class=\"modal-exercise-name\" id=\"modal-title\">${escapeHtml(exercise.name)}</h2>\n        <p class=\"modal-exercise-meta\">${escapeHtml(exercise.bodyPart)} • ${escapeHtml(exercise.target)} • ${exercise.burnedCalories} cal • ${exercise.time} min</p>\n        <p class=\"modal-exercise-description\">${escapeHtml(exercise.description || '')}</p>\n        <button type=\"button\" class=\"modal-exercise-fav\" data-remove-from-fav data-exercise-id=\"${escapeAttr(exercise._id)}\">Remove from Favorites</button>\n      `;\n      const favBtn = modalContent.querySelector('[data-remove-from-fav]');\n      if (favBtn && fav) {\n        favBtn.addEventListener('click', () => {\n          removeFavorite(exercise._id);\n          closeModal();\n          renderFavoritesList();\n        });\n      } else if (favBtn) favBtn.remove();\n    },\n    () => {\n      modalContent.innerHTML = '<div class=\"modal-loading\">Failed to load exercise.</div>';\n    }\n  );\n}\n\nloadQuoteFromStorage();\nrenderFavoritesList();\n\nconst burger = document.querySelector('[data-burger]');\nconst menu = document.querySelector('[data-header-menu]');\nif (burger && menu) {\n  burger.addEventListener('click', () => {\n    const open = menu.classList.toggle('is-open');\n    burger.setAttribute('aria-expanded', open);\n  });\n  menu.querySelectorAll('.header__nav-link').forEach((link) => {\n    link.addEventListener('click', () => {\n      menu.classList.remove('is-open');\n      burger.setAttribute('aria-expanded', 'false');\n    });\n  });\n}\nconst path = window.location.pathname;\ndocument.querySelectorAll('.header__nav-link').forEach((a) => {\n  const href = a.getAttribute('href');\n  const isCurrent = (href === './index.html' && !path.includes('favorites')) || (href === './favorites.html' && path.includes('favorites'));\n  a.classList.toggle('header__nav-link--current', isCurrent);\n});\n"],"names":["QUOTE_STORAGE_KEY","FAVORITES_STORAGE_KEY","getDateKey","d","getFavorites","removeFavorite","id","list","e","escapeAttr","str","div","escapeHtml","renderStars","rating","value","html","i","loadQuoteFromStorage","quoteText","quoteAuthor","today","stored","data","renderFavoritesList","listEl","emptyEl","ex","btn","openModal","modalBackdrop","modalContent","modalClose","closeModal","exerciseId","onClose","onBackdrop","onEscape","api.getExerciseById","exercise","fav","favBtn","burger","menu","open","link","path","a","href","isCurrent"],"mappings":"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"}